# Go RPC Gateway 配置文件示例
# 这是一个完整的配置示例，展示了所有可用的配置选项

# ============================================
# 基础配置 (基于 go-config SingleConfig)
# ============================================
app:
  name: "go-rpc-gateway"
  version: "1.0.0"
  env: "development"
  mode: "debug"

# ============================================
# 数据库配置
# ============================================
mysql:
  host: "127.0.0.1"
  port: "3306"
  config: "charset=utf8mb4&parseTime=True&loc=Local"
  dbname: "gateway_demo"
  username: "root"
  password: "123456"
  max_idle_conns: 10
  max_open_conns: 100
  log_level: "info"

# ============================================
# Redis配置
# ============================================
redis:
  db: 0
  addr: "127.0.0.1:6379"
  password: ""

# ============================================
# 对象存储配置 (MinIO)
# ============================================
minio:
  host: "127.0.0.1"
  port: 9000
  access_key: "minioadmin"
  secret_key: "minioadmin"

# ============================================
# JWT配置
# ============================================
jwt:
  signing_key: "go-rpc-gateway-secret"
  expires_time: "7d"
  buffer_time: "1d"
  issuer: "go-rpc-gateway"

# ============================================
# Gateway特有配置
# ============================================
gateway:
  name: "Go RPC Gateway Demo"
  version: "1.0.0"
  environment: "development"
  debug: true

  # HTTP服务器配置
  http:
    host: "0.0.0.0"
    port: 8080
    read_timeout: 30
    write_timeout: 30
    idle_timeout: 60
    max_header_bytes: 1048576

  # gRPC服务器配置
  grpc:
    host: "0.0.0.0"
    port: 9090
    max_recv_msg_size: 4194304
    max_send_msg_size: 4194304

  # 健康检查配置
  health_check:
    enabled: true
    path: "/health"

# ============================================
# 中间件配置
# ============================================
middleware:
  # CORS配置
  cors:
    enabled: true
    allow_origins: ["*"]
    allow_methods: ["GET", "POST", "PUT", "DELETE", "OPTIONS"]
    allow_headers: ["*"]
    allow_credentials: true

  # 限流配置
  rate_limit:
    enabled: true
    algorithm: "token_bucket"
    rate: 1000
    burst: 2000

  # 访问日志配置
  access_log:
    enabled: true
    log_requests: true
    log_responses: true

  # 认证配置
  auth:
    enabled: false
    type: "jwt"
    skip_paths: ["/health", "/metrics"]

  # 签名验证配置
  signature:
    enabled: false
    secret_key: "gateway-signature-secret"
    timestamp_tolerance: 300

# ============================================
# 监控配置
# ============================================
monitoring:
  # 指标监控
  metrics:
    enabled: true
    path: "/metrics"
    namespace: "gateway"
    subsystem: "http"

  # 链路追踪
  tracing:
    enabled: true
    service_name: "go-rpc-gateway"

# ============================================
# 日志配置
# ============================================
zap:
  level: "info"
  format: "console"
  prefix: "[GATEWAY]"
  director: "logs"
  show_line: true
  encode_level: "LowercaseColorLevelEncoder"
  stacktrace_key: "stacktrace"
  log_in_console: true

# ============================================
# 安全配置
# ============================================
security:
  enable_https: false
  cert_file: ""
  key_file: ""
  
  # 安全头配置
  security_headers:
    x_frame_options: "DENY"
    x_content_type_options: "nosniff"
    x_xss_protection: "1; mode=block"